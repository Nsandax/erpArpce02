{% extends "ErpProject/ModuleAchat/shared/layout.html" %} {% block page %}
{%load static %}





<div class="row">
    <ul class="breadcrumbs2 small">
        <li><a><span class="mif-home"></span></a></li>
        <li><a class="chargement-au-click" href="{% url 'module_achat_tableau_de_bord' %}">Module Achat</a></li>
        <li>{{ title }}</li>
    </ul>
</div>

<div class="row">
    <div class="col-lg-12">
        <h3>{{ title }}</h3>
        <strong style="float: right;color: grey;opacity: 0.85;margin-top: -30px;">{% now "jS F Y H:i" %}</strong>
        <div class="separ" style="background-color: grey;opacity: 0.2"></div>
            <div class="panel panel-default" style="border: none;">

                <div class="panel panel-body" style="background-color:#f5f5f5;border: none;border-radius: none;">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="panel panel-yellow">
                                <!--div class="panel-heading">
                                    <h4>Rapport des expressions des besoins</h4>
                                </div-->

                                    <div class="panel-body">
                                        <div class="row">
                                            <div class="col-md-2">
                                                <label>Valeur</label>
                                                <div class="input-control text full-size">
                                                    <select name="valeur" id="valeur"
                                                        data-validate-func="min"
                                                        data-validate-arg="1"
                                                        data-validate-hint="Sélectionnez le type d'article svp.">
                                                        <option value="total">Total</option>
                                                        <option value="1">Coût</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <label>Filtre</label>
                                                <div class="input-control text full-size">
                                                    <select name="filtre" id="filtre"
                                                        data-validate-func="min"
                                                        data-validate-arg="1"
                                                        data-validate-hint="Sélectionnez le type d'article svp.">
                                                        <option value="Expression">Expression des besoins</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <label>Choisir par</label>
                                                <div class="input-control text full-size">
                                                    <select name="choisir" id="choisir"
                                                        data-validate-func="min"
                                                        data-validate-arg="1"
                                                        data-validate-hint="Sélectionnez le type d'article svp.">
                                                        <option value="Employe">Employé</option>
                                                        <option value="Departement">Département</option>
                                                        <!--option value="Statut">Statut</!--option-->
                                                    </select>
                                                </div>
                                            </div>

                                            <div class="col-md-2">
                                                <label>Date debut</label>
                                                <div id="input-date-prevue" class="input-control text full-size" data-format="dd/mm/yyyy" data-role="datepicker" data-locale="fr">
                                                    <input readonly type="text" id="date_debut" name="date_debut" readonly data-validate-func="required" style="border: none;" data-validate-hint="Précisez la date d'enregistrement svp." class="form-control" value="{% now "d/m/Y" %}">
                                                    <div class="button primary_color_{{module.name|lower}}"><span class="mif-calendar" style="color: white;"></span></div>
                                                </div>
                                            </div>
                                            <div class="col-md-2">
                                                <label>Date fin</label>
                                                <div id="input-date-prevue" class="input-control text full-size" data-format="dd/mm/yyyy" data-role="datepicker" data-locale="fr">
                                                    <input readonly type="text" id="date_fin" name="date_fin" readonly data-validate-func="required" style="border: none;" data-validate-hint="Précisez la date d'enregistrement svp." class="form-control" value="{% now "d/m/Y" %}">
                                                    <div class="button primary_color_{{module.name|lower}}"><span class="mif-calendar" style="color: white;"></span></div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <br>

                                                <div id="select1" class="btn-group btn-group-toggle" data-toggle="buttons">
                                                    <label class="btn btn-default active">
                                                      <input type="radio" name="options" id="option1" class="bt" value="Forme" autocomplete="off" checked><i class="fas fa-chart-pie"></i>
                                                    </label>
                                                    <label class="btn btn-default">
                                                      <input type="radio" name="options" id="option2" class="bt" value="Colonne" autocomplete="off"><i class="fas fa-chart-bar"></i></i>
                                                    </label>
                                                    <label class="btn btn-default">
                                                      <input type="radio" name="options" id="option3" class="bt" value="Liste" autocomplete="off"><i class="fa fa-list" aria-hidden="true"></i>
                                                    </label>
                                                  </div>

                                                <div class="input-control text full-size" >
                                                    <button id="bout" onclick="click_button()" type='button' class="button button rounded primary primary_color_{{module.name|lower}}">Voir  <i class="fa fa-eye" aria-hidden="true"></i>                                                    </button>
                                                </div>
                                            </div>
                                        </div>


                                        <br>
                                        <div class="separ" style="background-color: grey;opacity: 0.2"></div>
                                        <br>

                                        <iframe id="iframe"
                                            title="iframe"
                                            id="iframe"
                                            style="min-height: 500px; width: 100%"
                                            style="background: #f5f5f5"
                                            frameborder="0"

                                            >
                                        </iframe>
                                    </div>
                                    <!--div class="panel-footer">
                                        <center>
                                            <button type="submit" style="width: 40%;" class="button small-button rounded primary chargement-au-click primary_color_{{module.name|lower}}">Voir</button>
                                        </center>
                                    </div-->

                            </div>
                        </div>


                    </div>

                </div>
            </div>
    </div>
    <!-- /.col-lg-12 -->
</div>


<script>

    var type = $('.btn-group > .btn.active > .bt').val();


    function click_button(){

        waitingDialog.show('Chargement Business Intelligence ...');setTimeout(function () {waitingDialog.hide();}, 2000);

        /* var num = null;
        $(".btn-group > button.btn").on("click", function(){
            num = +this.innerHTML;
            alert("Value is " + num);
        }); */

        var valeur = $("#valeur").val();
        var filtre = $("#filtre").val();
        var choisir = $("#choisir").val();
        var date_d = $("#date_debut").val();
        var date_f = $("#date_fin").val();


        var myIframe = document.getElementById('iframe');
        myIframe.addEventListener("load", function() {

        });
        var url = 'http://localhost/ReportServer/Pages/ReportViewer.aspx?%2fARPCE_Reports%2fModule_Achat%2fBI%2f'+ filtre+'%2f'+choisir+'%2f'+ type +'%2f'+valeur+'&rs:Command=Render&date_deb='+date_d+'&date_fin='+date_f+'&rc:Toolbar=false';
        console.log(url);
        myIframe.src = url;

    }


    $("#select1 input:radio").change(function() {
        type = $(this).val();
        click_button();

    });

</script>



{% endblock %}