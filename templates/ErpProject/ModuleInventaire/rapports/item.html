{% extends "ErpProject/ModuleInventaire/shared/layout.html" %} {% block page %}
{%load static %} {% load humanize %} {% load inventaire_filter %}
<div class="row" style="padding-top: 30px;">
    <div class="col-lg-12">
        <h2>{{ title }}</h2>
        <strong style="float: right;color: grey;opacity: 0.4;margin-top: -30px;">{% now "jS F Y H:i" %}</strong>
        <div class="separ" style="background-color: grey;opacity: 0.2"></div>
        <br>
        <div class="panel panel-default" style="border: none;">
            <div class="panel panel-body" style="background-color:white;">
                <div class="col-md-12">
                    <div class="col-md-12">
                        <h3><center><strong>{{title}}</strong></center></h3>
                    </div>
                    <div class="col-md-6">
                        {% include 'ErpProject/ErpBackOffice/widget/organisation.html' %}
                    </div>
                    <div class="col-md-6" style="text-align: right;">
                        <form action="{% url 'module_inventaire_post_mvt_stock' %}" method="POST">
                            {% csrf_token %}
                            <input name="filtre" type="hidden" value="{{filtre}}">
                            <input name="emplacement_origine_id" type="hidden" value="{{emplacement}}">
                            <input name="inventaire_de" type="hidden" value="{{rapport_de}}">
                            <input name="article_id" type="hidden" value="{{article_id}}">
                            <input name="categorie_id" type="hidden" value="{{categorie_id}}">
                            <input name="date_debut" type="hidden" value="{{date_debut}}">
                            <input name="date_fin" type="hidden" value="{{date_fin}}">
                            <input name="print" type="number" value="1" style="display:none">
                            <button type="submit" class="btn btn-default" style="background-color: #41435d;border:none;color: white;">
                                Imprimer
                            </button>
                        </form>
                        <!-- <button type="button" class="btn btn-default" style="background-color: #41435d;border:none;color: white;">
                            Imprimer
                        </button> -->
                    </div>
                    <div class="separ col-md-12" style="background-color: grey;opacity: 0.1;margin-bottom: 20px;"></div>
                    <div class="col-md-6">
                        <p>
                            <strong> Date:</strong> {{dates}}
                            <br>
                            <strong>Emplacement :</strong>{{txt_emplacement}}
                            <br>
                            <strong>Filtre :</strong> {{txt_filtre}}
                            <br>
                            <strong>Rapport sur </strong>
                            {% if rapport_de == 0 %} <strong>: {{rapport}} </strong> {% endif%}
                            {% if rapport_de == 1 %} <strong>  Catégorie :</strong> {{rapport}} {% endif%}
                            {% if rapport_de == 2 %} <strong>  Article :</strong> {{rapport}} {% endif%}
                        </p>
                    </div>
                    <!-- <div class="col-md-6" style="margin-bottom: 40px">
                        <p style="float: right;">
                            <strong>Date demande: {{model.date_expression | date:"d/m/Y" }}</strong>
                            <br>
                            <strong>Statut demande : {{model.etat}}</strong>
                            <br>
                            <strong>
                        </p>
                    </div> -->
                    <div class="col-md-12">
                        <table class="display nowrap border bordered striped" cellspacing="0" style="width: 100%;">
                            <tr>
                                <td class="head">Date</td>
                                <td class="head">Article</td>
                                <td class="head">Quantité</td>
                                <td class="head">Type</td>
                                <td class="head">Emplacement origine</td>
                                <td class="head">Emplacement final</td>
                                <td class="head">Numero</td>
                            </tr>

                            {% for item in model %}
                            <tr>
                                <td class="td">{{ item.creation_date | date:'d/m/Y H:i'}}</td>
                                <td class="td">{{ item.stock_article_entrant.article }}</td>
                                <td class="td"> {{item.quantite_mouvement | sep_float}} </td>
                                <td class="td">{{ item.type }} </td>
                                <td class="td">
                                    {% if item.stock_article_entrant %}
                                        {{ item.stock_article_entrant.emplacement.designation}}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                                <td class="td">
                                    {% if item.stock_article_sortant %}
                                        {{ item.stock_article_sortant.emplacement.designation}}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                                <td class="td">{{ item.reference }} </td>
                            </tr>
                            {% endfor %}

                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<script>
   function supprimer() {
        var id = '{{model.id}}'
        //-------deux variables pour la suppression---------------------------------
        var modele = "Model_Expression"
        var the_url = "module_achat_list_expression"
        //------- url de suppression ------------------------------------------------
        url = "{% url 'backoffice_supprimer_objet' '100' 'nom_modele' 'url_retour' %}";
        url = url.replace('100', id);
        url = url.replace('nom_modele', modele);
        url = url.replace('url_retour', the_url);
        document.location.href = url;


    }
    $('#supprimer').on('click', function () {


        Swal.fire({
            title: 'Etes vous sure?',
            text: "De vouloir supprimer cette item!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Oui, Supprime le!'
        }).then((result) => {
            if (result.value) {
                supprimer();
                Swal.fire(
                    'Supprimé!',

                    'Votre Item est supprimé',
                    'Avec Succes',
                )
            }
        })
    })

</script>


{% endblock %}
