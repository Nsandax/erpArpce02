{% extends "ErpProject/ModuleComptabilite/shared/layout.html" %}
{% block page %}
{%load static %}
{% load account_filters %}
<div class="row " style="background-color: #f5f5f5;">

    <div class="row">
        <!--div class="row">
            <button onclick="printScreen();"
                class="theme-btn theme-btn-sm rounded primary_color_{{module.name|lower}} chargement-au-click">Imprimer</button>
        </div-->
        <div  id="divToPrint" class="col-lg-12">
            <h2>{{title}}</h2>
            <strong style="float: right;color: grey;opacity: 0.85;margin-top: -30px;">{% now "jS F Y H:i" %}</strong>
            <div class="separ" style="background-color:floralwhite;opacity: 0.2"></div>

            <div class="panel panel-default" style="border: none;">
                <div id="export" class="panel panel-body"
                    style="background-color:#f5f5f5;border: none;border-radius: none;">



                    <img src="{% static 'ErpProject\image\header_rapport_o.png'%}" alt=""
                        style="width: 400px;height: 150px;">

                    <br>
                    <center>
                        <h1>{{designation}}</h1>
                    </center>
                    <center>
                        <h3>Etabli à la date du {{ model.date_operation|date:'d/m/Y' }}</h3>
                    </center>
                    <br>
                    <br>


                    <div class="row">

                        <table class="display table nowrap border bordered" cellspacing="0" style="width:100%">
                            <tbody>
                                <tr style="background-color:#91a7c3;color:#fff;font-weight:1000; font-size: 17;">
                                    <th>Date<br><br> </th>
                                    <th>N° PC<br><br></th>
                                    <th>Libéllé<br><br> </th>
                                    <th>Facture <br><br></th>
                                    <th>Type opération<br><br></th>
                                    <th>Montant<br><br></th>

                                </tr>
                                {% for ligne in ligne_operation %}
                                <tr>
                                    <td>{{ligne.date_ligne_operation|date:'d/m/Y'}}</td>
                                    <td>{{ligne.reference}}</td>
                                    <td>{{ligne.libelle}}</td>
                                    <td >{% if ligne.facture %} {{ligne.facture.numero_facture}} {% else %} - {% endif %}</td>
                                    <td>{{ligne.value_type_operation}}</td>
                                    <td  class="monetary">{{ligne.montant |monetary}}</td>


                                </tr>
                                {% endfor %}
                                <tr>

                                    <td colspan=5><span style="float: left; padding-left:50%;">TOTAL DE LA PAGE : </span> </td>
                                    <td colspan=3 class="monetary">{{model.solde}}</td>


                                </tr>
                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<button type="button" id="lancermodal" data-toggle="modal" data-target="#monmodal"
    style="display: none;">executer</button>
<div id="monmodal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body">
                <center>
                    <iframe id="iframemodal" frameborder="0" style="width: 100%;" height="600px"></iframe>
                </center>
                <hr>
                <center>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">FERMER</button>
                </center>
            </div>
        </div>
    </div>
</div>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/print.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/libs/jspdf.debug.js' %}"></script>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/libs/cell.js' %}"></script>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/libs/jspdf.plugin.autotable.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/libs/from_html.js' %}"></script>
        <script type="text/javascript" src="{% static 'ErpProject/js/pdf/libs/html2canvas.min.js' %}"></script>
<script>
    function printScreen() {
        const filename = 'journal.pdf';
        var pdf = new jsPDF('l', 'pt', 'ledger');
        pdf.html($('#divToPrint')[0], {
            callback: function (pdf) {

                var string = pdf.output('datauristring');
                $('#iframemodal').attr('src', string);
                $('#lancermodal').click();
            }
        });

        margins = {
            top: 70,
            bottom: 40,
            left: 30,
            width: 550
        };


    }
</script>
{% endblock %}